<div class="app-shell">
  <header class="app-header" role="banner">
    <figure class="app-logo">
      <img src="hatchly.png" alt="Hatchly" decoding="async" fetchpriority="high">
    </figure>
    <div class="app-title">
      <h1>Hatchly</h1>
      <div class="sub">Updated for ASA • Originally forked from Crumplecorn then diverged</div>
    </div>
  </header>
  <main class="panel" role="main" aria-labelledby="calcTitle">
    <div class="panel-head">
      <h3 id="calcTitle">Breeding & Maturation Planner</h3>
      <div class="subheading">Hover over labels for quick tips • Updated to v78.4</div>
    </div>
    <div class="panel-body">
      <div class="wrapperbox">
        <div class="box">
          <form>
            <div class="tableheader slide" ng-class="{'dimmed': !tablevisibility['ServerRates']}" ng-click="showhidetable('ServerRates')">Server Rates</div>
            <div class="tableslide" ng-show="tablevisibility['ServerRates']">
              <table>
                <tr>
                  <td style="width: 50%" class="label">Hatch Multiplier: </td>
                  <td>
                    <input ng-model="settings.hatchspeed" type="number" min="0" ng-change="selectsettings()">
                  </td>
                </tr>
                <tr>
                  <td style="width: 50%" class="label">Mature Multiplier: </td>
                  <td>
                    <input ng-model="settings.maturationspeed" type="number" min="0" ng-change="selectsettings()">
                  </td>
                </tr>
                <tr>
                  <td style="width: 50%" class="label">Consume Multiplier: </td>
                  <td>
                    <input ng-model="settings.consumptionspeed" type="number" min="0" ng-change="selectsettings()">
                  </td>
                </tr>
                <tr>
	                <td class="label">Server Type:</td>
	                <td>
		                <label>
			                <input type="checkbox"
				               ng-model="settings.isUnofficial"
				               ng-change="selectsettings()">
			                  Unofficial
		                </label>
	                </td>
                </tr>
              </table>
            </div>
            <div class="tableheader slide" ng-class="{'dimmed': !tablevisibility['Creature']}" ng-click="showhidetable('Creature')">Creature Details</div>
            <div class="tableslide" ng-show="tablevisibility['Creature']">
              <table>
                <tr>
                  <td style="width: 50%" class="label tooltip">Creature: <span class="tooltiptext">Creature type</span>
                  </td>
                  <td>
                    <select ng-show="displayconfig.showoldselects" ng-options="name as name for (name, details) in creatures" ng-model="creature.name" ng-change="switchcreature()"></select>
                    <input ng-hide="displayconfig.showoldselects" class="autocomplete" autocomplete data-source="creatures" ng-change="searchcreature()" data-default="creature.name" ng-model="creature.searchname">
                  </td>
                </tr>
                <tr>
                  <td style="width: 50%" class="label tooltip">Weight: <span class="tooltiptext">Weight stat of creature</span>
                  </td>
                  <td>
                    <input ng-model="creature.finalweight" ng-change="selectweight()" type="number">
                  </td>
                </tr>
                <tr>
                  <td style="width: 50%" class="label tooltip">Food Type: <span class="tooltiptext">Type of food used in all food stats below</span>
                  </td>
                  <td>
                    <select ng-options="food for food in foodlists[creatures[creature.name].type]" ng-model="foodunit" ng-change="selectweight()"></select>
                  </td>
                </tr>
              </table>
            </div>
            <div class="tableheader slide" ng-class="{'dimmed': !tablevisibility['Incubation']}" ng-click="showhidetable('Incubation')">Gestation/Incubation</div>
            <div class="tableslide" ng-show="tablevisibility['Incubation')">
              <table>
                <tr>
                  <td style="width: 50%" class="label tooltip">{{creature.birthlabel}}: <span class="tooltiptext">Time taken for {{creature.birthlabel}}</span>
                  </td>
                  <td>{{creature.birthtime | secondsToDateTime}}</td>
                </tr>
                <tr ng-if="creature.name === 'Elderclaw'">
                  <td class="label tooltip"> Greenhouse Effect: <span class="tooltiptext"> Crop plot growth speed from greenhouse structures (0–300%). 300% is max. </span>
                  </td>
                  <td>
                    <div style="display:flex;align-items:center;gap:10px;">
                      <input ng-model="settings.greenhousePercent" ng-change="selectsettings()" type="number" min="0" max="300" step="1" aria-label="Greenhouse effect percent" class="w-compact">
                      <span>%</span>
                    </div>
                  </td>
                </tr>
                <tr ng-if="creature.name === 'Elderclaw'">
                  <td class="label tooltip"> Shovel (Tilled): <span class="tooltiptext"> +30% crop-plot growth speed while tilled with a shovel. </span>
                  </td>
                  <td>
                    <label style="display:flex;align-items:center;gap:10px;">
                      <input type="checkbox" ng-model="settings.shovelTilled" ng-change="selectsettings()" aria-label="Shovel tilled">
                      <span>Apply +30% shovel boost</span>
                    </label>
                  </td>
                </tr>
              </table>
            </div>
            <div class="tableheader slide" ng-class="{'dimmed': !tablevisibility['Maturation']}" ng-click="showhidetable('Maturation')">Maturation</div>
            <div class="tableslide" ng-show="tablevisibility['Maturation']">
              <table>
                <tr>
                  <td style="width: 50%" class="label tooltip">Maturation: <span class="tooltiptext">Maturation progress of creature you want stats for</span>
                  </td>
                  <td>
                    <input ng-model="creature.maturationprogress" ng-change="selectmaturation()" percentage type="number" step="0.1" min="0" max="100">%
                  </td>
                </tr>
                <tr>
                  <td style="width: 50%" class="label tooltip">Elapsed Time: <span class="tooltiptext">Time elapsed since birth</span>
                  </td>
                  <td>{{creature.maturationtimecomplete | secondsToDateTime}}</td>
                </tr>
                <tr>
                  <td style="width: 50%" class="label tooltip">Time to Juvenile: <span class="tooltiptext">Time until creature hits juvenile</span>
                  </td>
                  <td>{{creature.babytimeremaining | secondsToDateTime}}</td>
                </tr>
                <tr>
                  <td style="width: 50%" class="label tooltip">Time to Adult: <span class="tooltiptext">Time until creature hits adult</span>
                  </td>
                  <td>{{creature.maturationtimeremaining | secondsToDateTime}}</td>
                </tr>
                <tr>
                  <td style="width: 50%" class="label tooltip">Food to Juvenile (E): <span class="tooltiptext">{{foodunit}} the creature will actually eat (i.e. no spoilage) between now and reaching juvenile</span>
                  </td>
                  <td>{{creature.tojuvfooditems | number:0}}</td>
                </tr>
                <tr>
                  <td style="width: 50%" class="label tooltip">Food to Adult (E): <span class="tooltiptext">{{foodunit}} the creature will actually eat (i.e. no spoilage) between now and reaching adult</span>
                  </td>
                  <td>{{creature.toadultfooditems | number:0}}</td>
                </tr>
                <tr>
                  <td style="width: 50%" class="label tooltip">Food Rate (E): <span class="tooltiptext">Food point the creature will currently eat every {{settings.foodrate_time_units}}</span>
                  </td>
                  <td>
                    {{creature.nextminfood}} pt / <select ng-options="unit as unit for (unit, multi) in foodrate_time_units" ng-model="settings.foodrate_time_units" ng-change="totalfoodcalc()"></select>
                  </td>
                </tr>
                <tr>
                  <td style="width: 50%" class="label tooltip">Food per period (E): <span class="tooltiptext">{{foodunit}} the creature will actually eat during the next {{settings.foodrate_time_units}}</span>
                  </td>
                  <td>{{creature.nextfoodpertimeunit}} per {{settings.foodrate_time_units}}</td>
                </tr>
              </table>
            </div>
            <!-- Baby Phase -->
            <div class="tableheader slide" ng-class="{'dimmed': !tablevisibility['Baby']}" ng-click="showhidetable('Baby')">Baby Phase</div>
            <div class="tableslide" ng-show="tablevisibility['Baby']">
              <table>
                <tr>
                  <td style="width: 50%" class="label tooltip">Current Buffer: <span class="tooltiptext">How long the baby will last with a full inventory of {{foodunit}}</span>
                  </td>
                  <td>{{creature.currentbabybuffer | secondsToDateTime}}</td>
                </tr>
                <tr>
                  <td style="width: 50%" class="label tooltip">Food to Fill: <span class="tooltiptext">The amount of {{foodunit}} the baby's inventory can currently hold</span>
                  </td>
                  <td>{{creature.foodtofill | number:0}}</td>
                </tr>
                <tr>
                  <td style="width: 50%" class="label tooltip">Hand Feed For: <span class="tooltiptext">How long from now until the baby can survive to juvenile on a full inventory, and the maturation at which this occurs</span>
                  </td>
                  <td>{{creature.lasthandfeed | secondsToDateTime}} ({{creature.lasthandfeedmaturation | percentage}}%)</td>
                </tr>
                <tr>
                  <td style="width: 50%" class="label tooltip">Food to Finish: <span class="tooltiptext">Amount of food required in the baby's inventory to reach juvenile</span>
                  </td>
                  <td>{{creature.foodtofinishbaby}}</td>
                </tr>
                <tr>
                  <td style="width: 50%" class="label tooltip">Desired Buffer: <span class="tooltiptext">How long you would like between feedings</span>
                  </td>
                  <td>
                    <input ng-model="creature.desiredbabybuffer" ng-change="desiredbuffercalc()" type="number" min="1"> Minutes
                  </td>
                </tr>
                <tr>
                  <td style="width: 50%" class="label tooltip">Time Until Buffer: <span class="tooltiptext">How long until the baby's inventory is big enough to provide your desired buffer, and the maturation at which this occurs</span>
                  </td>
                  <td>{{creature.timeuntildesiredbabybuffer | secondsToDateTime}} ({{creature.timeuntildesiredbabybuffermaturation | percentage}}%)</td>
                </tr>
              </table>
            </div>
            <!-- Food Per Day -->
            <div class="tableheader slide" ng-class="{'dimmed': !tablevisibility['Food']}" ng-click="showhidetable('Food')">Food Per Day</div>
            <div class="tableslide" ng-show="tablevisibility['Food']">
              <table>
                <tr>
                  <td style="width: 50%" class="label tooltip">Loss Factor: <span class="tooltiptext">Percentage of food you assume will be lost to spoilage</span>
                  </td>
                  <td>
                    <input ng-model="settings.lossfactor" ng-change="totalfoodcalc()" type="number">
                  </td>
                </tr>
                <tr ng-repeat="(day,food) in creature.fooditemsforday">
                  <td style="width: 50%" class="label tooltip">Day {{day}} Food <span class="tooltiptext">{{foodunit}} required on day {{day}} of maturation</span>
                  </td>
                  <td>{{food | number:0}}</td>
                </tr>
              </table>
            </div>
            <!-- Trough Calculator - Food -->
            <div class="tableheader slide" ng-class="{'dimmed': !tablevisibility['Trough']}" ng-click="showhidetable('Trough')"> Trough Calculator - Food </div>
            <div class="tableslide" ng-show="tablevisibility['Trough']">
              <table>
                <tr>
                  <td style="width: 50%" class="label tooltip"> Trough Type: <span class="tooltiptext"> Sets the spoil rate of the food based on the container you will use, Tek=100x, Normal=4x, Clicker=1x </span>
                  </td>
                  <td>
                    <select ng-options="type as type for (type, multi) in troughtypes" ng-model="settings.troughtype" ng-change="troughcalc()"></select>
                  </td>
                </tr>
                <tr ng-repeat="(food, stacks) in troughstacks">
                  <td style="width: 50%" class="label tooltip">
                    {{food}}
                    <span class="tooltiptext">Stacks of {{foods[food].stack}} {{food}} in troughs</span>
                  </td>
                  <td>
                    <input ng-model="troughstacks[food]" ng-change="troughcalc()" type="number"> Stacks
                  </td>
                </tr>
                <tr ng-repeat="(type, time) in troughdata.times">
                  <td style="width: 50%" class="label tooltip">
                    {{type}}: <span class="tooltiptext">How long {{type}}s will have food in the current configuration</span>
                  </td>
                  <td>{{time | secondsToDateTime}}</td>
                </tr>
                <tr>
                  <td style="width: 50%" class="label tooltip"> Loss <span class="tooltiptext"> Amount of food points to spoilage, cooking meat is automatic 50% loss </span>
                  </td>
                  <td>{{(troughdata.spoiledpoints+troughdata.wastedpoints)/troughdata.totalpoints*100}}%</td>
                </tr>
              </table>
            </div>
            <!-- Trough Calculator - Creatures -->
            <div class="tableheader slide" ng-class="{'dimmed': !tablevisibility['TroughCreatures']}" ng-click="showhidetable('TroughCreatures')"> Trough Calculator - Creatures </div>
            <div class="tableslide" ng-show="tablevisibility['TroughCreatures']">
              <table>
                <thead>
                  <td>Creature</td>
                  <td>Maturation</td>
                  <td>Quantity</td>
                  <td>Remove</td>
                </thead>
                <tr>
                  <td>
                    <input type="button" ng-click="troughaddcreature()" value="Add Creature">
                  </td>
                </tr>
                <tr ng-repeat="(index, troughcreature) in creaturelist">
                  <td>
                    <select ng-options="name as name for (name, details) in creatures" ng-model="troughcreature.name" ng-change="troughupdatefoodtypes(); troughcalc();"></select>
                  </td>
                  <td>
                    <input ng-model="troughcreature.maturation" type="number" min="0" max="1" step="0.01" ng-change="troughcalc()"> (0–1)
                  </td>
                  <td>
                    <input ng-model="troughcreature.quantity" type="number" min="1" step="1" ng-change="troughcalc()">
                  </td>
                  <td>
                    <input type="button" value="X" ng-click="troughremovecreature(index); troughcalc();">
                  </td>
                </tr>
              </table>
            </div>
            <div class="tableheader slide" ng-class="{'dimmed': !tablevisibility['Changelog']}" ng-click="showhidetable('Changelog')">Changelog</div>
            <div class="tableslide" ng-show="tablevisibility['Changelog']">
              <ul class="changes-list" id="changelog-list">
                <li> Updated creature list. <br />
                  <ul>
                    <li ng-repeat="creature in creatureChanges">
                      {{creature.name}} has been {{creature.status}}.
                    </li>
                  </ul>
                </li>
                <!-- The list will be dynamically populated with ASA dinos -->
              </ul>
            </div>
          </form>
        </div>
      </div>
      <p class="footer">Built with AngularJS • Theme refresh for ASA look & feel</p>
    </div>
  </main>
</div>
